{
  "course": "DSM100-2022-OCT",
  "topic": "Topic 4: Quantifying uncertainty",
  "title": "Lecture 4: Bayesian networks",
  "url": "https://learn.london.ac.uk/mod/page/view.php?id=96208&forceview=1",
  "transcript": "=[music]In the previous mini lecture, we considered an example Bayesian network.In that example, you could contact your boss by email or Skype message,and she would respond depending if she is in office or not,and the likelihood of you responding.In this mini lecture, we will seehow to implement this network in Python.For that, we will be using pgmpy.Pgmpy is a pure Python implementation of Bayesian networks.You can visit their website, pgmpy.org,and you can download it,unless you already have it.It comes with Anaconda, for example, but it's very easy to install.Just use pip install pgmpy.I recommend visiting their website in any case,because they have really good tutorial, and many implemented Bayesian networks.Please study these examples, it will help you.For our example, first of all, we make surethat we have all what we need, like libraries.We will import NumPy,and we also will import TabularCPD.CPD is conditional probability distribution,and Bayesian model, and we will import [?].First thing that we do is here, redefining our Bayesian model.It's just like an array, and we explicitly statewhat nodes are connected to what nodes, like InOffice is connected to Skype,and InOffice is connected to email node.Skype is connected to response node, and email is connected to response node,so this is our structure.Now, we have to define all TabularCPDfor each node,so all our probability distributions.The node InOffice has two values,yes or no, so it's a variable cardwith cardinality 2.We just state these values, and we do the same for each node.Other nodes are more complicated, but the same logic applies.The node Skype is still cardinality 2, but valuesare of more complicated structure.Pay attention here because it's conditional probability.Evidence is InOffice, so it's evidence card,so what we defined before.It's here now, evidence card.If it's InOffice, probability of answeringon Skype message is 1, if she's not in office,it's less than 0.2.The same with the node response,or the same with the node email--It's very symmetric, and the response is even more complicated.It has 2 evidence now, Skype and email, and the values reflect it,so this is a more complicated structure, evidence card is 2.2.It's a very simple Bayesian network, and you can imaginethat you have to be careful with this structure when you import itfor more complicated Bayesian networks.That is why it's quite important to checkthat the [?] is attached correctly.You attach it, and then it's really goodto check get_cpdsand see if it can really process it.You can activate these nodes, and it's also good to checkthese independencies, so get_independencies,and you will see what depends, and also what response.If it's InOffice, it depends Skype, email, and so on.To do some fun stuff, like probabilistic inference,you need this import variable elimination.We do that, and now we can calculateall sorts of probabilities.For example, here,probability of response if--Probability of response will be this, so what is probabilityof getting response? It's 0.65.Then, what is probability of getting response on Skype message?Here are your probabilities and so on.You can ask more interesting questionslike, what is probability of responseif boss is in office?You can calculate this.If boss is in office, what is chance that she will respond?Then you can see probabilityof getting email responseand Skype response if boss in office.Some probabilities are probably most obvious,and some are less obvious.Let's see something more interesting.Here, they're just the probability--Let's see--If you got response by Skype,what's the chancethat the boss is in office?It calculates--Behind, there are all these laws of probabilities,and of course, [?] starting from the very top node,it propagates to other nodes.Whatever you can think about any conditional probabilitiesthat involve these four modes, you can express, and it will calculate.What can you do?You can extend it, so here is an sample an extension.In company, messages usually are sentto management team.You can use a common email address, and it can go to director or deputy.You also can send a message to Skype accountwhich only director has access to.If at least one of the directors or deputies receivesand checks the message, it will usually be responded.We also can [?], like director is in office,there's probability of 50%, director is at home,there's probability of 20%, director is in business trip,there's probability of 30%, deputy is at office,there's a probability of 70%.Director usually doesn't check Skype messageswhen in office, 10% checks.Director sometimes checks Skype messages when at home, about 30%.Director very unlikely to check Skype messages in business trip, 1%.When one of the director or deputy are in office,the email will be checked with high probability, 90%.When both director and deputy are in office,the email will be checked with a very high probability, 95%.When none of the director or the deputy are in office,the email will be checked with a low probability, 5%.How to capture it-- We can extend our Bayesian network.Basically, where [?] node, we have director and deputy,so a structure change.Then here, we have a different Bayesian model,so very similar, but we addedthis director and deputy thing.Again, we have structure,and then we definethis conditional probability distribution for each node.For director, we now have three cardinalities.Three, because it can be in office, on business trip, or at home.We have deputy, there are two, in office and not office, and so on,so each node is defined.Then again, we can check if we understand it so correctly,and we then check in independencies.We got more nodes, you see already how complexity grows.Again, we can then do variable elimination,and then do reasoning.We can ask all sorts of questions.What is the chance of getting a response?Quite high, 0.68.Thenwe have here,what is probability of getting a responseon Skype message?Not very high.All these probabilities can be used when decision support systemmakes decision,how to contact by Skype or email.If you can imagine a system that is connected to some other systems,so maybe there is some calendar where it's marked business trip.If there is this additional evidence that the boss is on business trips,it all can be recalculated in this Bayesian network,and you can have more accurate estimates.Here, probability email responseis very high, 0.95.The probability of getting a response from deputy also, 0.87.You can calculate it all again manually, but it's very complicated.[?] formulas,it's all hardly encodedin this implementation.This is how to implement the Bayesian networks.You can ask all sorts of questions.What is probability of getting a response?What is probability of getting a response from a deputy?What is probability of getting a response by email if deputy not in office?Whatever you can see in combinations, you can ask these questions,and you will get numerical estimates of the probabilities.Once again, I recommend visiting pgmpy.orgto see other examplesof Bayesian networks, and I hope you can extendthese examples further just to practice, or you can createyour own Bayesian network."
}